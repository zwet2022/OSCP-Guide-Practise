## Server Side Template Injection

### Steps

#### 1. Identification

**Reflecting Endpoints**

If there are reflecting endpoints like `/file?urlparam=example` and `example` is reflected in the frontend, this may be a valid attack service.

This idea can be used with Stored Reflected Input to, try it out on name inputs with registration functionalitys.

**Backend Software**

SSTI Injections most of the time only work on template engines used by frameworks in Python (flask), PHP (Symfony) and othere sometimes java frameworks.

#### 2. Proof of Concept

**Try it out**

SSTI most of the time will lead to file inclusion, private information exposure or RCE.

To see if your target is vuln, do the simple injection of:

```
{{2*2}}
<%= 3 * 3 %>
${6*6}
${{3*3}}
@(6+5)
#{3*3}
#{ 3 * 3 }
```

if one of these gives the multiplied answer in the reflected output of the site, it is **SSTI** vulnerable.

#### 3. Post exploitation

Try to found out what the backend is, by causing errors. 

Then search for the suitable RCE command:

```
https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-4r7v-whpg-8rx3?source=post_page-----5d721bd08071---------------------------------------

https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation?source=post_page-----5d721bd08071---------------------------------------

https://github.com/payloadbox/ssti-payloads
```